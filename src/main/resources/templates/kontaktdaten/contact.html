<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kontaktdaten</title>

    <!-- Einbindung von Bootstrap für das Styling -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="contact.js"></script>

    <style>
        /* Globale Stile für alle Elemente */
        * {
            box-sizing: border-box;
        }

        /* Stile für den gesamten Körper (Body) */
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #e9dece;
        }

        /* Stile für Überschrift 1 (H1) */
        h1 {
            font-size: 36px;
            color: #333;
            text-align: center; /* Zentrierung des Headers */
            margin-bottom: 20px;
        }

        /* Stile für das Formular */
        form {
            max-width: 600px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1); /* Hinzugefügt: Schatten für das Formular */
        }

        /* Stile für die Beschriftung von Eingabefeldern (Label) */
        label {
            margin-top: 10px;
        }

        /* Stile für Dropdown, Eingabefelder und Textfelder */
        select,
        input,
        textarea {
            margin-bottom: 15px;
        }

        /* Stile für den Absende-Button */
        input[type="submit"],
        input[type="button"] {
            background-color: #007bff;
            color: #fff;
            cursor: pointer;
            margin-right: 10px;
        }

        /* Stile für den Absende-Button beim Hovern (Mouseover) */
        input[type="submit"]:hover,
        input[type="button"]:hover {
            background-color: #0056b3;
        }

        /* Stile für die Tabelle */
        table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }

        th,
        td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #007bff;
            color: #fff;
        }

        /* Stile für die Edit- und Delete-Buttons in der Tabelle */
        .action-buttons button {
            background-color: #28a745;
            color: #fff;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            margin-right: 5px;
        }

        .action-buttons button:hover {
            background-color: #218838;
        }

        .action-buttons button.delete {
            background-color: #dc3545;
        }

        .action-buttons button.delete:hover {
            background-color: #c82333;
        }
    </style>
</head>

<body>
<!-- Header -->
<h1>Kontaktdaten - Arztpraxis</h1>

<!-- Table to display saved contacts -->
<h2>Gespeicherte Kontakte</h2>
<table class="table">
    <thead>
    <tr>
        <th>Vorname</th>
        <th>Nachname</th>
        <th>Strasse</th>
        <th>Ort</th>
        <th>PLZ</th>
        <th>Email</th>
        <th>Telefonnummer</th>
        <th>Aktionen</th>
    </tr>
    </thead>
    <tbody id="kontaktTableBody"></tbody>
</table>

<!-- Kontaktformular -->
<form action="kontaktverarbeitung.php" method="post" id="kontaktForm">

    <div class="container">

        <label for="vorname">Vorname:</label>
        <input type="text" class="form-control" id="vorname" name="vorname" required>

        <label for="nachname">Nachname:</label>
        <input type="text" class="form-control" id="nachname" name="nachname" required>

        <!-- Adresse-Textfeld -->
        <br><label for="strasse" class="form-label">Strasse:</label>
        <textarea class="form-control" id="strasse" placeholder="Strasse eingeben" name="strasse" required></textarea>

        <label for="ort" class="form-label">Ort:</label>
        <input type="text" class="form-control" id="ort" placeholder="Ort eingeben" name="ort" required>

        <label for="plz" class="form-label">PLZ:</label>
        <input type="text" class="form-control" id="plz" placeholder="PLZ eingeben" name="plz" required>

        <!-- Email-Eingabefeld -->
        <label for="email" class="form-label">Email:</label>
        <input type="email" class="form-control" id="email" placeholder="Email eingeben" name="email" required>

        <!-- Telefonnummer-Eingabefeld -->
        <label for="telefon" class="form-label">Telefonnummer:</label>
        <input type="tel" class="form-control" id="telefon" placeholder="Telefonnummer eingeben" name="telefon"
               required>

        <!-- Nutzungsbedingungen Checkbox -->
        <input type="checkbox" id="nutzungsbedingungen" name="nutzungsbedingungen" required>
        <label for="nutzungsbedingungen">Ich akzeptiere die Nutzungsbedingungen</label>

        <br><br>

        <!-- Submit-Button -->
        <input type="button" value="Kontaktdaten speichern" onclick="speichereKontaktdaten()">

    </div>

</form>

<script>
    // Funktion zum Darstellen der Kontakte in der Tabelle
    function renderContacts() {
        var kontakteArray = JSON.parse(localStorage.kontakte || '[]');
        var tableBody = document.getElementById('kontaktTableBody');
        tableBody.innerHTML = ''; // Clear existing rows

        for (var i = 0; i < kontakteArray.length; i++) {
            var kontakt = kontakteArray[i];
            var row = tableBody.insertRow();
            row.insertCell().innerText = kontakt.Vorname;
            row.insertCell().innerText = kontakt.Nachname;
            row.insertCell().innerText = kontakt.Strasse;
            row.insertCell().innerText = kontakt.Ort;
            row.insertCell().innerText = kontakt.PLZ;
            row.insertCell().innerText = kontakt.Email;
            row.insertCell().innerText = kontakt.Telefonnummer;

            // Action buttons
            var actionCell = row.insertCell();
            var editBtn = createButton('Edit', createEditHandler(i));
            var deleteBtn = createButton('Delete', createDeleteHandler(i), 'delete');
            actionCell.appendChild(editBtn);
            actionCell.appendChild(deleteBtn);
        }
    }

    // Function to create a button with a specified text and click handler
    function createButton(text, clickHandler, className = '') {
        var button = document.createElement('button');
        button.innerText = text;
        button.onclick = clickHandler;
        button.className = 'btn btn-sm ' + className;
        return button;
    }

    // Function to create an edit button handler
    function createEditHandler(index) {
        return function () {
            fillFormForEditing(index);
        };
    }

    // Function to create a delete button handler
    function createDeleteHandler(index) {
        return function () {
            deleteContact(index);
        };
    }

    // Funktion zum Befüllen des Formulars für die Bearbeitung basierend auf der ausgewählten Zeile
    function fillFormForEditing(index) {
        var kontakteArray = JSON.parse(localStorage.kontakte || '[]');
        var kontakt = kontakteArray[index];

        // Fill form fields with the selected contact's data
        document.getElementById('vorname').value = kontakt.Vorname;
        document.getElementById('nachname').value = kontakt.Nachname;
        document.getElementById('strasse').value = kontakt.Strasse;
        document.getElementById('ort').value = kontakt.Ort;
        document.getElementById('plz').value = kontakt.PLZ;
        document.getElementById('email').value = kontakt.Email;
        document.getElementById('telefon').value = kontakt.Telefonnummer;

        // Store the index of the contact being edited
        document.getElementById('kontaktForm').setAttribute('data-edit-index', index);
    }

    // Function to delete a contact
    function deleteContact(index) {
        var kontakteArray = JSON.parse(localStorage.kontakte || '[]');
        kontakteArray.splice(index, 1); // Remove the contact at the specified index
        localStorage.kontakte = JSON.stringify(kontakteArray);

        // Update the table
        renderContacts();
    }

    // Your existing save function
    function speichereKontaktdaten() {
        var editIndex = document.getElementById('kontaktForm').getAttribute('data-edit-index');

        var vorname = document.getElementById('vorname').value;
        var nachname = document.getElementById('nachname').value;
        var strasse = document.getElementById('strasse').value;
        var ort = document.getElementById('ort').value;
        var plz = document.getElementById('plz').value;
        var email = document.getElementById('email').value;
        var telefon = document.getElementById('telefon').value;

        var kontakt = {
            Vorname: vorname,
            Nachname: nachname,
            Strasse: strasse,
            Ort: ort,
            PLZ: plz,
            Email: email,
            Telefonnummer: telefon
        };

        if (!localStorage.kontakte) {
            localStorage.kontakte = JSON.stringify([]);
        }

        var kontakteArray = JSON.parse(localStorage.kontakte);

        if (editIndex !== null) {
            // Update existing contact if editing
            kontakteArray[editIndex] = kontakt;
            document.getElementById('kontaktForm').removeAttribute('data-edit-index');
        } else {
            // Add new contact if not editing
            kontakteArray.push(kontakt);
        }

        localStorage.kontakte = JSON.stringify(kontakteArray);

        // Clear form fields
        document.getElementById('kontaktForm').reset();

        // Rufen Sie renderContacts beim Laden der Seite auf, um vorhandene Kontakte anzuzeigen
        renderContacts();
    }

    renderContacts();
</script>

</body>
</html>
